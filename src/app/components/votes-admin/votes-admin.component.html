<mat-drawer-container class="example-container">
    <mat-drawer #drawer class="example-sidenav" mode="side" opened fixedInViewport="true" fixedTopGap="top">
        <img src="../../../assets/imgs/UNEF.png" alt="">
        <a mat-list-item routerLink=".">Empresas asociadas</a>
        <a mat-list-item routerLink=".">Votaciones</a>
    </mat-drawer>

    <mat-toolbar class="example-toolbar">
        <button mat-icon-button (click)="drawer.toggle()"><mat-icon>menu</mat-icon></button>
    </mat-toolbar>
    <mat-sidenav-container>
        <mat-sidenav [mode]="mobileQuery.matches ? 'over' : 'side'" [fixedInViewport]="mobileQuery.matches"
            fixedTopGap="56">
            <mat-nav-list>
            </mat-nav-list>
        </mat-sidenav>
        <mat-sidenav-content>
            <div class="container">
                <h2 class="secondary-color">EMPRESAS ASOCIADAS</h2>
                <form [formGroup]="formAdmin">
                    <div class="d-flex">
                        <div class="row">
                            <mat-form-field class="col-lg-3 col-md-3 col-sm-6">
                                <mat-label>Buscar Empresa</mat-label>
                                <input type="text" matInput [formControl]="company">
                            </mat-form-field>
                            <mat-form-field class="col-lg-3 col-md-3 col-sm-6">
                                <mat-label>NIF</mat-label>
                                <input type="text" matInput formControlName="nif">
                            </mat-form-field>
                            <mat-form-field class="col-lg-2 col-md-2 col-sm-6">
                                <mat-label>Sección</mat-label>
                                <mat-select formControlName="section">
                                    @for (section of listSection; track $index) {
                                    <mat-option [value]="section._id">{{section.section}}</mat-option>
                                    }
                                </mat-select>
                            </mat-form-field>
                            <mat-form-field class="col-lg-2 col-md-2 col-sm-6">
                                <mat-label>Tipo</mat-label>
                                <mat-select formControlName="type">
                                    <mat-option>Selecciona un tipo</mat-option>
                                    <mat-option value="default">Vota</mat-option>
                                    <mat-option value="delegate">Delega</mat-option>
                                </mat-select>
                            </mat-form-field>
                            <div class="col-lg-2 col-md-2 col-sm-6 mt-3">
                                <button class="button-search white primary-color-back w-100" mat-raised-button>Buscar</button>
                            </div>
                        </div>
                    </div>
                </form>
                <div class="d-flex justify-content-end my-3">
                    <div class="icon-download">
                        <span class="color-primary icon-download-large">
                            <i class="bi bi-file-earmark-excel-fill"></i>
                        </span>
                    </div>
                </div>
                <table class="table mt-5">
                    <thead class="thead-dark">
                        <tr>
                            <th scope="col" class="color-primary">Empresa asociada</th>
                            <th scope="col" class="color-primary">NIF</th>
                            <th scope="col" class="color-primary">Sección</th>
                            <th scope="col" class="color-primary">Email de contacto</th>
                            <th scope="col" class="color-primary">País</th>
                            <th scope="col" class="color-primary">Código acceso</th>
                            <th scope="col" class="color-primary">Asistencia</th>
                            <th scope="col" class="color-primary">Tipo Vota/Delega</th>
                        </tr>
                    </thead>
                    <tbody>
                        @for (enterprise of listEnterprise | paginate: { itemsPerPage: 10, currentPage: currentPage }; track $index ) {
                        <tr>
                            <td>{{enterprise.name}}</td>
                            <td>{{enterprise.nif}}</td>
                            <td>{{enterprise.section}}</td>
                            <td>{{enterprise.email}}</td>
                            <td>{{enterprise.contry}}</td>
                            <td>{{enterprise.code}}</td>
                            <td>
                                <section>
                                    <mat-slide-toggle color="primary" [(ngModel)]="enterprise.status" (change)="updateEnterpriseAsist(enterprise)">
                                    </mat-slide-toggle>
                                </section>
                            </td>
                            <td>
                                <mat-form-field>
                                    <mat-label>Vota/Delega</mat-label>
                                    <mat-select [(value)]="enterprise.type_vote" (selectionChange)="openDialog(enterprise)" >
                                        <mat-option value="default">Vota</mat-option>
                                        <mat-option value="delegate">Delega</mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </td>
                        </tr>
                        }
                    </tbody>
                </table>
                <pagination-controls (pageChange)="onPageChange($event)" previousLabel="Anterior"
                    nextLabel="Siguiente"></pagination-controls>
            </div>
        </mat-sidenav-content>
    </mat-sidenav-container>

</mat-drawer-container>